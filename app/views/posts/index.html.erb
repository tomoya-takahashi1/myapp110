<div class="container mt-5 pt-5">
   <% if flash[:notice] %>
    <div class="alert alert-success">
      <%= flash[:notice] %>
    </div>
  <% end %>
</div>

<div class="bd-example text-center mt-5" style="position: relative;">
  <h2 class="overlay-title">Habit</h2>
  <p>--習慣で人生が変わる--</p>
  <div class="overlay-text">
    <p class="overlay-description">
      トレーニングした記録を共有できるサイトです<br>理想のボディに近づけるように今日も頑張りましょう!<br>みんなの投稿を見て、イカしたトレーニングを見つけたらお気に入り登録しておこう！
    </p>
  </div>
  <img src="https://www.d-sp.co.jp/maebashi/wp/wp-content/uploads/2020/06/shutterstock_311106002.jpg" class="img-fluid" alt="Responsive image">
</div>

<section id="components">
  <article class="my-3" id="accordion">
    <div>
      <div class="bd-example">
        <div class="accordion" id="accordionExample">
          <div class="accordion-item d-none d-sm-block">
            <h4 class="accordion-header" id="headingOne">
              <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                トレーニングは必要なのか
              </button>
            </h4>
            <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <strong>トレーニングをするメリットはたくさんある.</strong><br> 1つ目健康的な生活をおくれる<br>2つ目老若男女関係なく始められる<br>3つ目精神的に安定する</br>
              </div>
            </div>
          </div>
          <div class="accordion-item d-none d-sm-block">
            <h4 class="accordion-header" id="headingTwo">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                習慣にしないと人間は行動できない
              </button>
            </h4>
            <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <strong>トレーニングを習慣にすることは難しい辛い、大変、苦しい、すぐに結果に現れないだからこそ記録することに意味がある</strong> 
              </div>
            </div>
          </div>         
          <div class="accordion-item d-none d-sm-block">
            <h4 class="accordion-header" id="headingThree">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                人間は承認欲求の塊
              </button>
            </h4>
            <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#accordionExample">
              <div class="accordion-body">
                <strong>他の人に見てもらえることで頑張れる自分以外にも頑張っている人がいるからこそ自分も頑張れる</strong> 
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </article>
</section>

<div class="text-center mt-3 d-flex flex-wrap justify-content-center mt-5">
  <%= link_to "-新着投稿-", "#", id: "new-posts-link", class: "me-3 mb-2" %>
  <%= link_to "-人気投稿-", "#", id: "popular-posts-link", class: "mb-2" %>
</div>

<div class="container  pt-5">
  <div class="row">
    <div class="col-12 mx-auto px-0" id="new-posts">
      <p class="text-center ">新着投稿</p>
        <div class="table-responsive">
          <table class="table custom-table">
            <thead class="thead-dark">
              <tr>
                <th scope="col">種目</th>
                <th scope="col">投稿者</th>
                <th scope="col">回数</th>
                <th scope="col">器具、<br>プロテイン</th>
                <th scope="col">トレーニング部位</th>
                <th scope="col">更新日</th>
                <th scope="col">作成日</th>
                <th scope="col">参照</th>
                <th scope="col">編集</th>
                <th scope="col">削除</th>
                <th scope="col">いいね</th>
              </tr>
            </thead>
            <tbody>
              <% @posts.reverse_each do |post| %>
                <td class="text-center"><%= post.name %></td>
                <td class="text-center"><%= post.user.name %></td>
                <td class="text-center"><%= post.set %></td>
                <td class="text-center"><%= post.introduction %></td>
                <td class="text-center"><%= post.muscle %></td>
                <td class="text-center"><%= post.updated_at.to_s(:datetime_jp) %></td>
                <td class="text-center"><%= post.created_at.to_s(:datetime_jp) %></td>
                <td class="text-center">
                  <%= link_to post, class: "btn btn-sm btn-primary" do %>
                    <i class="fas fa-eye"></i> 参照
                  <% end %>
                </td>
                <td class="text-center">
                  <% if current_user == post.user %>
                    <%= link_to [:edit, post], class: "btn btn-sm btn-info" do %>
                      <i class="fas fa-edit"></i> 編集
                    <% end %>
                  <% else %>
                    &nbsp; 
                  <% end %>
                </td>
                <td class="text-center">
                  <% if current_user == post.user %>
                    <%= button_to post, method: :delete, class: "btn btn-sm btn-danger", data: { confirm: '本当に削除しますか？' } do %>
                      <i class="fas fa-trash"></i> 削除
                    <% end %>
                  <% else %>
                    &nbsp; 
                  <% end %>
                </td>
                <td class="text-center">
                  <div class="favorite-wrapper">
                  <% if current_user && current_user.already_favorited?(post) %>
                    <%= button_to post_favorites_path(post_id: post.id), method: :delete, class: "favorite-button" do %>
                    <i class="fas fa-heart"></i>
                  <% end %>
                  <% else %>
                    <%= button_to post_favorites_path(post_id: post.id), method: :post, class: "favorite-button" do %>
                    <i class="far fa-heart"></i>
                  <% end %>
                  <% end %>
                  <span class="favorite-count"><%= post.favorites.count %></span>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
          </table>
        </div>
    </div>
    <div class="col-12 mx-auto" id="popular-posts" >
      <p class="text-center mt-5 px-0">人気投稿</p>
        <div class="table-responsive">
         <table class="table custom-table">
          <thead class="thead-dark">
            <tr>
              <th scope="col">種目</th>
              <th scope="col">投稿者</th>
              <th scope="col">回数</th>
              <th scope="col">種目内容</th>
              <th scope="col">更新日</th>
              <th scope="col">作成日</th>
              <th scope="col">参照</th>
              <th scope="col">編集</th>
              <th scope="col">削除</th>
              <th scope="col">いいね</th>
            </tr>
          </thead>
          <tbody>
            <% @popular_posts.each do |post| %>
              <tr>
                <td class="text-center"><%= post.name %></td>
                <td class="text-center"><%= post.user.name %></td>
                <td class="text-center"><%= post.set %></td>
                <td class="text-center"><%= post.introduction %></td>
                <td class="text-center"><%= post.updated_at.to_s(:datetime_jp) %></td>
                <td class="text-center"><%= post.created_at.to_s(:datetime_jp) %></td>
                <td class="text-center">
                  <%= link_to post, class: "btn btn-sm btn-primary" do %>
                    <i class="fas fa-eye"></i> 参照
                  <% end %>
                </td>
                <td class="text-center">
                  <% if current_user == post.user %>
                    <%= link_to [:edit, post], class: "btn btn-sm btn-info" do %>
                      <i class="fas fa-edit"></i> 編集
                    <% end %>
                  <% else %>
                    &nbsp; 
                  <% end %>
                </td>
                 <td class="text-center">
                  <% if current_user == post.user %>
                    <%= button_to post, method: :delete, class: "btn btn-sm btn-danger", data: { confirm: '本当に削除しますか？' } do %>
                      <i class="fas fa-trash"></i> 削除
                    <% end %>
                  <% else %>
                    &nbsp; 
                  <% end %>
                </td>
                <td class="text-center">
                  <div class="favorite-wrapper">
                    <% if current_user.already_favorited?(post) %>
                    <%= button_to post_favorites_path(post_id: post.id), method: :delete, class: "favorite-button" do %>
                    <i class="fas fa-heart"></i>
                  <% end %>
                  <% else %>
                    <%= button_to post_favorites_path(post_id: post.id), method: :post, class: "favorite-button" do %>
                    <i class="far fa-heart"></i>
                  <% end %>
                  <% end %>
                  <span class="favorite-count"><%= post.favorites.count %></span>
                  </div>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
        </div>
    </div>
  </div>
</div>
